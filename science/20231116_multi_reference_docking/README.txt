Ended up running the array version of this! Easier than managing the memory issues
